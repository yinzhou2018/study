## 核心概念
- **窗口设置尺寸**：窗口设置尺寸是指在窗口所在进程内通过API设置的宽度和高度，单位为像素，在进程内调整或获取窗口尺寸时，都是这个尺寸；
- **窗口屏幕尺寸**：窗口屏幕尺寸是指窗口在屏幕上呈现的宽度和高度，单位为像素，在进程外调整或获取窗口尺寸时是屏幕尺寸，分几种情况：
  - 当窗口所属进程设置为DPI无感知（`DPI_AWARENESS_SYSTEM_AWARE`）时，应用没做任何设置默认是这个值，**屏幕尺寸 = DPI / 96 * 设置尺寸**；
  - 当窗口所属进程设置为系统DPI感知（`DPI_AWARENESS_SYSTEM_AWARE`）时，应用只查询一次系统DPI值，**屏幕尺寸 = 实时DPI / 查询DPI * 设置尺寸**, 如果系统DPI设置在应用运行期间改了或窗口从一个屏幕移动到了另一个屏幕，可能就跟设置尺寸不相等，
  - 当窗口所属进程设置为监视器DPI感知（`DPI_AWARENESS_PER_MONITOR_AWARE`）时，**屏幕尺寸 = 设置尺寸**；
- **窗口DC**: 窗口DC是指窗口的设备绘制上下文，底层的**画布像素大小总是窗口设置尺寸**；

## 基本结论
- win平台有4种截屏（窗口）方式，分别是GDI、PrintWindow、DXGI及WGC;
- DXGI及WGC(Window Graphics Capture)方式有初始化成本，初始化后获取单帧非常快，使用相对复杂，更适合连续高性能抓取屏幕（窗口）帧流场景;
- DXGI只能获取整个屏幕帧，WGC可以同时支持指定窗口，两者对操作系统版本都有要求，DXGI需要win8+, WGC需要win10+;
- WGC截取窗口时，窗口不能处于最小化状态，否则获取不到帧;
- 普通的静态截屏应用适合用GDI方式，有最好的系统兼容性，但无法截取采用SwapChain Flip模式渲染的窗口（比如Chrome）;
- PrintWindow也适合普通的静态截屏场景，使用简单，win8开始支持截取硬件加速窗口;
- **当窗口有原生的系统边框及标题栏时，PrintWindow方式截取的系统边框都是黑色，而GDI截取不到系统标题栏**;

  ![bench](./bench.png)